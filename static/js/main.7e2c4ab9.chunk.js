(this["webpackJsonpdino-app"]=this["webpackJsonpdino-app"]||[]).push([[1],{47:function(e,n,t){},48:function(e,n,t){},51:function(e,n,t){},60:function(e,n){function t(e){return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}))}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=60},61:function(e,n){function t(e){return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}))}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=61},62:function(e,n,t){var i={"./ion-icon.entry.js":[88,12]};function o(e){if(!t.o(i,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=i[e],o=n[0];return t.e(n[1]).then((function(){return t(o)}))}o.keys=function(){return Object.keys(i)},o.id=62,e.exports=o},72:function(e,n,t){},83:function(e,n,t){},84:function(e,n,t){"use strict";t.r(n);var i,o=t(4),r=t.n(o),c=t(31),s=t.n(c),a=t(14),l=t(53),u=t(20),d=t(13),j=(t(47),t(28)),O=t(15),b=t(27),v=t(5),f=t(6);!function(e){e.SET_MODE="SET_MODE",e.SET_STATE="SET_STATE",e.INTRODUCTION="INTRODUCTION",e.ERROR="ERROR",e.REQUEST_PREVIEW="REQUEST_PREVIEW",e.STREAM="STREAM"}(i||(i={}));var h,g=i;!function(e){e.USERNAME="USERNAME",e.TOKEN="TOKEN",e.ERROR="ERROR",e.AVAILABLE_MODES="AVAILABLE_MODES"}(h||(h={}));var p=h,E=function(){function e(){Object(v.a)(this,e)}return Object(f.a)(e,null,[{key:"websocket",get:function(){var e=this;if(!this._websocket){var n,t=null===(n=localStorage.getItem(p.TOKEN))||void 0===n?void 0:n.replace(/[^a-z0-9-]/gim,"");this._websocket=new WebSocket("wss://dino.petrusbellmonte.de",[null!==t&&void 0!==t?t:"no-token","dino"]),console.log(t),this._websocket.onopen=function(){var n;console.log("socket opened..."),null===(n=e._websocket)||void 0===n||n.send(JSON.stringify({origin:e.myOrigin,type:g.INTRODUCTION,args:{name:localStorage.getItem(p.USERNAME),type:"APP"}}))},this._websocket.onerror=function(e){console.log(e)},this._websocket.onclose=function(n){e._websocket=void 0},this._websocket.onmessage=function(n){try{var t=JSON.parse(n.data);switch(console.log(t),t.type){case g.INTRODUCTION:var i=t;if("server"===i.origin.toLowerCase())e.introduction=i,e.triggerListenersByType(Object(b.a)(Object(b.a)({},t),{},{type:g.SET_STATE,args:{newState:t.args.currentState}})),document.dispatchEvent(new CustomEvent(p.AVAILABLE_MODES,{detail:e.introduction.args.availableModes}));else if(e.introduction){var o,r;console.log("wtf");var c=e.introduction.args.availableModes.map((function(e){return e.type}));e.introduction.args.availableModes=[].concat(Object(O.a)(e.introduction.args.availableModes),Object(O.a)((null!==(o=null!==(r=i.args.availableModes)&&void 0!==r?r:i.args.possibleModes)&&void 0!==o?o:[]).filter((function(e){return!c.includes(e.type)})))),console.log("updating available modes... Now: ".concat(JSON.stringify(e.introduction.args.availableModes))),document.dispatchEvent(new CustomEvent(p.AVAILABLE_MODES,{detail:e.introduction.args.availableModes})),e.triggerListenersByType(t)}else console.log("weird shit");break;case g.SET_MODE:case g.SET_STATE:e.triggerListenersByType(t);break;case g.ERROR:throw new Error(t.args.message)}}catch(s){console.warn(s),document.dispatchEvent(new CustomEvent(p.ERROR,{detail:s.msg}))}}}return this._websocket}},{key:"triggerListenersByType",value:function(e){this.actionListeners.filter((function(n){return n.actionType===e.type})).forEach((function(n){return n.listener(e)}))}},{key:"addListener",value:function(e,n){this.websocket;var t=Math.max.apply(Math,Object(O.a)(this.actionListeners.map((function(e){return e.id}))))+1;return this.actionListeners=[].concat(Object(O.a)(this.actionListeners),[{id:t,actionType:e,listener:n}]),t}},{key:"removeListener",value:function(e){this.actionListeners=this.actionListeners.filter((function(n){return n.id!==e}))}}]),e}();E.introduction=void 0,E._websocket=void 0,E.myOrigin=Math.random().toString().replace(/^../,""),E.actionListeners=[];var m,w=function(e){var n,t=Object(o.useState)(null!==(n=window["LAST_".concat(e)])&&void 0!==n?n:null),i=Object(d.a)(t,2),r=i[0],c=i[1];Object(o.useEffect)((function(){var n=E.addListener(e,(function(n){window["LAST_".concat(e)]=n,c(n)}));return function(){E.removeListener(n)}}),[e]);return[r,function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ALL";E.websocket.send(JSON.stringify({origin:E.myOrigin,type:e,address:t,args:n}))}]},x=function(e,n){var t,i,r=Object(o.useState)(null!==(t=JSON.parse(null!==(i=localStorage.getItem(e))&&void 0!==i?i:"null"))&&void 0!==t?t:n),c=Object(d.a)(r,2),s=c[0],a=c[1];return Object(o.useEffect)((function(){var n=function(e){a(e.detail),console.log("update modes"+JSON.stringify(e.detail))};return document.addEventListener(e,n),function(){return document.removeEventListener(e,n)}}),[]),[s,function(n){localStorage.setItem(e,JSON.stringify(n));var t=new CustomEvent(e,{detail:n});document.dispatchEvent(t)}]},S=(t(48),t(12)),y=function(e){var n=e.title,t=w(g.SET_STATE),i=Object(d.a)(t,2),o=i[0],r=i[1],c=x(p.USERNAME),s=Object(d.a)(c,1)[0];return Object(S.jsx)(a.e,{children:Object(S.jsxs)(a.v,{children:[Object(S.jsx)(a.c,{slot:"start",children:Object(S.jsx)(a.b,{className:(null===o||void 0===o?void 0:o.args.newState)?"active":"inactive",onClick:function(){return r({newState:!(null===o||void 0===o?void 0:o.args.newState)})},children:Object(S.jsx)(a.f,{slot:"icon-only",icon:j.e})})}),Object(S.jsxs)(a.t,{children:[n,", ",s]}),Object(S.jsx)(a.c,{slot:"end",children:Object(S.jsx)(a.m,{})})]})})},T=function(){Object(u.e)().name;var e=x(p.USERNAME,""),n=Object(d.a)(e,2),t=n[0],i=n[1],o=x(p.TOKEN,""),r=Object(d.a)(o,2),c=r[0],s=r[1];return Object(S.jsxs)(a.p,{children:[Object(S.jsx)(y,{title:"Settings"}),Object(S.jsxs)(a.d,{children:[Object(S.jsx)("p",{children:"This is the settings page!"}),Object(S.jsxs)(a.j,{children:[Object(S.jsxs)(a.h,{children:[Object(S.jsx)(a.i,{position:"floating",children:"Username"}),Object(S.jsx)(a.g,{name:"username",value:t,onIonChange:function(e){var n;return i(null!==(n=e.detail.value)&&void 0!==n?n:"")}})]}),Object(S.jsxs)(a.h,{children:[Object(S.jsx)(a.i,{position:"floating",children:"Token"}),Object(S.jsx)(a.g,{type:"password",name:"token",value:c,onIonChange:function(e){var n;return s(null!==(n=e.detail.value)&&void 0!==n?n:"")}})]})]})]})]})},k=t(39),L=t(21);t(49),t(50),t(51);!function(e){e.COLOR="COLOR",e.NUMBER="NUMBER"}(m||(m={}));var N=m,R=function(e){var n=e.mode,t=w(g.SET_MODE),i=Object(d.a)(t,2),r=(i[0],i[1]),c=Object(o.useState)([]),s=Object(d.a)(c,2),l=s[0],u=s[1];Object(o.useEffect)((function(){u(Object.keys(n.params).map((function(e){return[e,n.params[e]]})))}),[n]);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("h1",{children:n.name}),Object(S.jsx)("p",{children:n.description}),l.map((function(e){var n=Object(d.a)(e,2);return function(e,n){var t;return Object(S.jsxs)(a.h,{children:[Object(S.jsx)(a.i,{children:n.name}),Object(S.jsx)("input",{type:n.type===N.NUMBER?"number":"color",value:null!==(t=n.value)&&void 0!==t?t:n.defaultValue,onChange:function(n){u((function(t){return t.map((function(t){var i=Object(d.a)(t,2),o=i[0],r=i[1];return o===e?[o,Object(b.a)(Object(b.a)({},r),{},{value:n.target.value})]:[o,r]}))}))}})]},e)}(n[0],n[1])})),Object(S.jsx)(a.b,{onClick:function(){return r({newMode:Object(b.a)(Object(b.a)({},n),{},{params:l.reduce((function(e,n){var t=Object(d.a)(n,2),i=t[0],o=t[1];return e[i]=o}),{})})})},children:"Apply"})]})};function A(){var e=x(p.AVAILABLE_MODES),n=Object(d.a)(e,1)[0],t=w(g.SET_MODE),i=Object(d.a)(t,2);i[0],i[1];return Object(S.jsx)(k.a,{spaceBetween:50,loop:!0,navigation:!0,pagination:!0,id:"dino-slides",children:null===n||void 0===n?void 0:n.map((function(e){return Object(S.jsx)(k.b,{children:Object(S.jsx)(R,{mode:e},e.type)},e.type)}))})}L.c.use([L.a,L.b]);var M=function(){return Object(S.jsxs)(a.p,{children:[Object(S.jsx)(y,{title:"Dino \ud83e\udd95"}),Object(S.jsxs)(a.d,{children:[Object(S.jsx)("h1",{style:{textAlign:"center"},children:"Mein geiler Dino!"}),Object(S.jsx)(A,{})]})]})},_=function(){var e=w(g.INTRODUCTION),n=Object(d.a)(e,1)[0],t=Object(o.useState)(),i=Object(d.a)(t,2),r=i[0],c=i[1];return Object(o.useEffect)((function(){var e;(null===n||void 0===n?void 0:n.origin)&&(c("".concat(null!==(e=null===n||void 0===n?void 0:n.args.name)&&void 0!==e?e:"A new device"," connected!")),setTimeout((function(){return c(void 0)}),4e3))}),[n]),Object(S.jsx)(a.u,{isOpen:!!r,color:"success",message:r})},I=(t(72),[{title:"Manage Dinos",url:"/",iosIcon:j.c,mdIcon:j.d},{title:"Settings",url:"/Settings",iosIcon:j.a,mdIcon:j.b}]),D=function(){var e=Object(u.d)();return Object(S.jsx)(a.l,{contentId:"main",type:"reveal",side:"end",children:Object(S.jsx)(a.d,{children:Object(S.jsxs)(a.j,{id:"menu-list",children:[Object(S.jsx)(a.k,{children:"DinoAPP"}),Object(S.jsx)(a.o,{children:"Control your dinos from everywhere \ud83c\udf89"}),I.map((function(n,t){return Object(S.jsx)(a.n,{autoHide:!1,children:Object(S.jsxs)(a.h,{className:e.pathname===n.url?"selected":"",routerLink:n.url,routerDirection:"none",lines:"none",detail:!1,children:[Object(S.jsx)(a.f,{slot:"start",ios:n.iosIcon,md:n.mdIcon}),Object(S.jsx)(a.i,{children:n.title})]})},t)}))]})})})};t(73),t(74),t(75),t(76),t(77),t(78),t(79),t(80),t(81),t(82),t(83);Object(a.E)({});var U=function(){return Object(S.jsxs)(a.a,{children:[Object(S.jsx)(l.a,{children:Object(S.jsxs)(a.s,{contentId:"main",children:[Object(S.jsx)(D,{}),Object(S.jsxs)(a.r,{id:"main",children:[Object(S.jsx)(u.a,{path:"/",exact:!0,children:Object(S.jsx)(M,{})}),Object(S.jsx)(u.a,{path:"/Settings",exact:!0,children:Object(S.jsx)(T,{})})]})]})}),Object(S.jsx)(_,{})]})},C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function B(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(Object(S.jsx)(r.a.StrictMode,{children:Object(S.jsx)(U,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");C?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var i=t.headers.get("content-type");404===t.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):B(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):B(n,e)}))}}()}},[[84,2,3]]]);
//# sourceMappingURL=main.7e2c4ab9.chunk.js.map